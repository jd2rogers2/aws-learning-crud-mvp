### section 3 - cloud computing
- deployment models
    - private cloud
        - company owns servers
    - public cloud
        - company rents servers
        - economies of scale
            - we only need to pay for what we need
            - they provide cheaper product because they can afford scale
        - on demand
        - self service
    - on prem
        - we handle everything
    - Infra as a Service
        - they handle:
            - networking
            - storage
            - computers
        - i.e. EC2
    - Platform as a Service
        - infra managed by them
        - we manage just app + data
        - i.e. Elastic Beanstalk
    - Software as a Service
        - working product provided by them
- geography
    - regions
        - a cluster of data centers
        - most services scoped to a region
        - services aren't available in all regions
        - i.e. "us-northwest"
    - availability zones
        - within a region
        - i.e. "us-northwest-1a"
        - separate from each other for availability purposes
    - global services
        - iam
- shared responsibility model
    - we're responsible for security of what we put in the cloud
    - they're responsible for networking, hardware, etc. security

### section 4 - IAM
- global service
- root user = do not use except to create admin user and other users
- IAM users (devs)
    - these still use the root user account_id or alias. so it feels like they're really sub-users
    - create these accounts and then send the signin link to them
    - they should set up MFA
    - they should set a new pw on first sign in
    - they configure their local terminal by creating an access key and secret
    - can also use the cloud shell
    - create multiple access keys for different integrations (i.e. sdk (app layer lib use))
- groups
    - a set of users
    - can be assigned policies at this level
- policies
    - what the assigned (group or user) is allowed to do
    - json
        - statement: [{}]
            - effect - deny || allow
            - action "service:ability"
- roles
    - like a user but for a service
    - for when a service needs to perform an action
    - that way we can allow or deny service integrations
    - can be assigned to individual service instances (i.e. an EC2 vm)
- best practices
    - MFA
    - rotate keys every X (90) days

### section 5 - EC2
- he had me set up a "budget"
    - i had to leave the NpC org to do this. orgs must own billing if you're part of one
    - budgets are basically alerts for a billing threshold
- EC2 = elastic compute cloud
- it's infra as a service
- it's made up of:
    - instances = the hardware
    - EBS - data volumes
    - ELB - elastic load balancer
    - ASG - auto scaling group (kube?)
- lots of config options
    - cloud (EBS || EFS) storage or local (on the EC2 instance)
    - OS (mac|linux|win)
    - CPU
    - how much ram
    - network card (?)
    - firewall rules
    - startup/bootstrap script "user data"
        - only on first startup
- t2.micro - is the type of instance we'll use most
    - part of free tier
    - 1GB ram
    - 1 CPU
    - only EBS storage
    - med/low performance (this is enough)
- creating my first instance
    - mostly within browser, filling out form for config
    - he provided a startup script
    - instances have public and private IP addresses
        - private is for within network
    - AMI = amazon machine image
        - like docker image but for spinning up instance
        - select OS, etc.
    - !! user data only runs on very first start, not on restart
- security groups
    - network perimssions for instance(s)
    - everything denied by default
    - can allow incoming IP, what port on instance is accessible
    - can allow another security group access (used for intra service connections)
    - use 0.0.0.0/0 to allow external connections, to a certain port, from anywhere
    - live outside of your instance
    - important ports to know:
        - 22 - ssh connections (including SFTP (secure/ssh FTD))
        - 21 - FTP
        - 80 - http
        - 443 - https
    - !!! connection timeouts 100% due to security groups
- ssh
    - for secure shell connection to our instances
    - use PUTTY for windows
    - can use "EC2 instance connect"
    - unix uses ssh command
    - add security group to allow ssh on port 22
    - mac cmd:
        - chmod 0400 ~/path/to/key.pem
        - ssh -i ~/path/to/key.pem ec2-user@[IPv4]
- more configs
    - so far, instances have been "on-demand"
        - no commitment
        - highest cost
    - other options:
        - reserved
            - 1 & 3 year plans
            - for long run time jobs (DB)
            - cheaper but locks you in for longer
        - spot instances - idk the diff between on-demand
            - UNRELIABLE
        - dedicated host - you get the whole server
        - dedicated instance - you don't share hardware
### section 6 - EC2 storage
- EBS volume
    - elastic block store
    - can only be mounted to 1 EC2 instance at a time
    - bound to specific availability zone
    - 30 GB/month
    - connects to EC2 instance via network
    - config GBs and I/O/s ahead of time
    - gp2 is the most common volume type
    - EXAM topic
        - can configure "delete on termination" property
        - EC2 instance comes with a "root" EBS which has "delete on term." turned on
    - CRUD with these volumes is very similar to EC2s
    - using the EBS from EC2 is out of scope for this course?!
    - can make snapshots to copy to a diff AZ or region, or to archive
    - un archiving takes 24-72 to come back online
    - config to keep EBS volume around for up to 1 year after deleting
    - the snapshot is not the actual volume, you create volumes from the snapshot
- EC2 instance store
    - better performance than EBS because it's a physical connection to your EC2 instance
    - but it's ephemeral!
- EFS
    - shared network file system
    - can be "mounted" to multiple EC2 instances
    - and across multiple availability zones
    - 3x more expensive than gp2
    - EFS-IA (infrequent access)
        - cold storage
    - use a lifecycle policy to auto move unused files to cold storage
- AMI overview (amzn machine image)
    - yes like an image in docker
    - using the "user data" bootup script from before, we can:
        1. create an EC2 instance
        2. create an image off of that
        3. faster! start up of instances made with new image
- EC2 image builder
    - way to test AMIs
    - creates test instance of the AMI
    - can config to run regularly, when new depencies update, etc.
    - lessons didn't actually run tests on an instance though :(
- shared responsibility model for EC2 instance storage
    - aws' responsibility
        - infra
        - replication process
        - replacing faulty hardware
        - employees cannot see data
    - our responsibility
        - backing up via snapshots, etc.
        - data encryption
        - responsible for all data on the hardware
        - understanding ephemeralness of EC2
- FSx
    - 3rd party storage option
    - shared file system
    - we set up FSx and it accesses non-aws data center
    - 3 types:
        - FSx for windows file server
        - FSx for Lustre (linux cluster)
### ELB & ASG
- Elastic load balancer & auto scaling groups
- MANAGED load balancer
    - aws maintains availability for you
- scalability = ability to grow vertically or horizontally, to handle more load
- elasticity = automated scaling
- 4 load balancer options
    - application load balancer
        - http/https only - layer 7
    - network load balancer
        - tcp - layer 4
        - ultra high perf
    - gateway load balancer
        - IP - layer 3
        - directs to 3rd party security service on your machine then to app layer
    - classic load balancer
        - retired 2023
        - layer 4, 7
- ELB (application load balancer) impl in aws ui
    - have existing EC2 instances
    - put them in a security group
        - that has the same port exposed via http, anywhere
    - point new ELB at that group
- ASG (auto scaling group) impl in aws ui
    - no existing EC2s
    - create ASG
    - create launch template (same as EC2 form)
    - connect to existing ELB
    - define scaling config
        - min (1), desired, max
    - deleted instances under the load balancer
    - created ASG and selected existing load balancer
    - terminate one instance and ASG brought up another automatically
- ASG dashboard shows activity history of elastic scales
- types of scaling
    - manual
    - dynamic
        - simple/step scaling - when avg load hits a certain limit, add or remove instance
        - target scaling - set desired load (40%) and will try to keep all instances around there
        - scheduled scaling - you define when to bring on more instances (you know when users will be online)
    - predicted scaling - AWS ML uses past activity to bring on more instances
### S3
- "infinitely" scaling storage
- static storage
    - good for static site host
- buckets with unique name across all regions
- buckets are globally available but live only within 1 region
- bucket names with alpha, num, and dash only
- object and file storage
- object store with keys for "location"
    - no real folders but ui displays it that way
- keys are really just unique strings, we use file structure path looking thing
    - s3://bucket-name/prefix/filename.txt
- objects have properties:
    - metadata
    - tags
    - version ID (if enabled)
- security for a bucket:
    - user based - IAM user policies
    - resource based
        - bucket or object policies
        - service roles (i.e. ec2 instance role)
    - encrypt objects with encryption key
    - policies
        - similar to IAM
        - they are json objects
        - key/vals:
            - resource[] = paths of bucket, directories, objects that the policy applies to
                - ...folder/* for all objects in folder
            - effect = allow | disallow
            - action = read, write, etc. i.e. "GetObject"
            - principal = who. * for everyone
        - use the policy generator to create one
        - there is an implicit deny
            - all requests are denied unless there is an explicit allow


#### action items
- DONE - create admin group with "admin access" policy
- DONE - reread "roles" section to review as it's a new concept






